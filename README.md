# EasyPage
### Mybatisè‡ªå®šä¹‰åˆ†é¡µå™¨æ’ä»¶

#### è¯·æŠŠä»¥ä¸‹éƒ½å½“æˆæ˜¯yy

ä¸€èˆ¬éƒ½æ˜¯ç”¨PageHelperï¼Œä½†æ˜¯éšç€æ•°æ®é‡å˜å¤§ï¼ŒSQLå˜å¤æ‚æ•ˆç‡ä½äº†ä¸å°‘ï¼Œåº¦å¨˜çš„ç­”æ¡ˆéƒ½æ˜¯ä»SQLå…¥æ‰‹æƒ³åŠæ³•æé«˜æ•ˆç‡ï¼Œå¯æ˜¯æˆ‘çš„é—®é¢˜ä¸æ˜¯åœ¨SQLä¸Šï¼Œä»…ä»…æ˜¯PHå°è£…SQLå°±ç”¨äº†3ç§’ï¼Œæˆ‘çš„SQLåœ¨æœåŠ¡å™¨ä¸Šè·‘ä¹Ÿå°±0.003må•Šï¼ŒğŸ˜…ğŸ˜…ğŸ˜…

ç„¶åå°±å»ç¿»PHæºç ï¼Œæ‰“æ–­ç‚¹çœ‹å•Šçœ‹ï¼Œé€»è¾‘è¿˜æ˜¯ä¸å°‘çš„...

#### ç¬¬ä¸€ä¸ªæƒ³æ³•

ç„¶åæƒ³è‡ªå·±å®ç°ä¸€ä¸ªï¼Œå¼€å§‹æ˜¯æƒ³è¦åŸç”Ÿçš„åˆ†é¡µå™¨å°±æ˜¯é‚£ç§ä¸€ä¸ªå®ä½“ç±»ï¼Œç„¶åæ‰§è¡Œä¸€æ¡COUNTä¹‹ç±»çš„ï¼Œåˆè€ƒè™‘åˆ°è‡ªå·±çš„å¼ºè¿«ç—‡ï¼ˆCOUNTä¸èƒ½å¤ç”¨å•Šï¼Œæœ‰æœ¨æœ‰ğŸ˜¬èƒ½å¤ç”¨çš„ï¼‰ã€‚

ä»¥ä¸‹æ˜¯åºŸè¯å•§å•§ï¼Œæœ€åˆçš„æƒ³æ³•ï¼Œæˆ‘åŠ¨æ€ä»£ç†Mapperæ¥å£ï¼Œç„¶åå“¼å“¼æ”¹SQLï¼Œæå‰æ‰§è¡ŒCOUNTï¼Œè‹¥COUNT=0é‚£å’±ä»¬å°±ä¸æŸ¥è¯¢äº†ï¼Œè¿™æ ·æ•ˆç‡è¿˜é«˜å•§å•§ï¼Œå¤©æ‰ï¼ğŸ˜ï¼ˆåæ¥å‘ç°PHå·²ç»æœ‰è¿™ä¸ªåŠŸèƒ½äº†ï¼Œæ‰“è„¸æ‰“è„¸ğŸ¤¬ï¼‰,ä½†æ˜¯æœ‰ä¸ªé—®é¢˜å°±æ˜¯....å°±ç®—æˆ‘èƒ½ä»£ç†Mapperå¯¹è±¡ï¼Œå¼ºè¡Œæ‹¿SQLï¼Œå¼ºè¡Œæ”¹ï¼Œæˆ‘å¼ºè¡Œ....æ€ä¹ˆæ‰§è¡Œå‘¢ï¼Œå¥—ä½ çŒ´å­çš„ğŸ˜‚ï¼Œæ€»ä¸èƒ½æ‹¿JDBCè·‘ä¸€ä¸‹å§ï¼Œå†ä»¿ä¸€ä¸ªMybatisæ—¥å¿—ï¼Œç²¾å½©ï¼~~~é¢†å¯¼ä»¥ä¸ºæˆ‘ç”¨Mybatisæ‰§è¡Œçš„ğŸ¤£ï¼ˆé¢†å¯¼ï¼šä»¥ä¸ºæˆ‘å‚»ï¼ŸğŸ˜ï¼‰ã€‚

#### ä¸‹ä¸€æ­¥

å¾ˆä¸æƒ³å»å†™ä¸€ä¸ªPHç±»ä¼¼çš„æ’ä»¶ï¼Œå› ä¸º...æˆ‘è¿˜è¦é‡æ–°å¤ä¹ Mybatisæºç æœ‰æœ¨æœ‰ï¼Œè¿˜å¾—å­¦ä¹ ä¸€ä¸‹PHçš„å®ç°é€»è¾‘..å‘•ï¼ˆå†…å¿ƒï¼šæˆ‘è¦åˆ’æ°´ï¼ğŸ¤—ï¼‰ï¼Œæœ€ç»ˆè´¥åœ¨è‡ªå·±çš„å¼ºè¿«ç—‡ä¸‹ã€‚

æœ€ç»ˆDeBugäº†PageHeplerï¼Œå¤ä¹ äº†Mybatisæºç ï¼Œäº†è§£äº†å†…ç½®å¯¹è±¡ã€æ‰§è¡Œè¿‡ç¨‹ç­‰ç­‰ç­‰ç­‰...ç„¶åä»ç½‘ä¸Šæ‰’äº†ä¸€ä»½è¯•äº†è¯•ï¼Œå—¯å¯ä»¥çš„ä¸é”™ï¼Œé‚£æˆ‘å°±åªå°è£…ä¸€ä¸ªSpringBootStarterå§ï¼ŒçœŸæ‡’å•ŠğŸ¤¨ã€‚å°±è¿™æ ·å°±è¿™æ ·å¤§æ¦‚ä¸‰å¤©æ—¶é—´å°±å‡ºæ¥äº†ã€‚

### é…ç½®å’Œä½¿ç”¨

å› ä¸ºå°è£…äº†AutoConfigurationç±»ï¼Œæ‰€ä»¥è®©ä»–è‡ªå·±è£…è‡ªå·±å°±å¥½äº†ğŸ˜ï¼Œæˆ‘è£…æˆ‘è‡ªå·±ã€‚

ä»¥ä¸‹é…ç½®ä¸ä¸€å®šå¿…é¡»è¦æœ‰ï¼Œå› ä¸ºæœ‰é»˜è®¤é…ç½®ï¼Œçº¦å®šå¤§äºé…ç½®ã€‚

ä½†æ˜¯ä¹Ÿå¯ä»¥è‡ªå·±é…ç½®ï¼Œå°±åƒPHçš„æ–¹è¨€ä¸€æ ·ï¼Œæˆ‘æ˜¯è°æˆ‘åœ¨å“ª

#### é…ç½®

```yml
easypage: #ymlæ–‡ä»¶
  dialect: mysql  #æ”¯æŒmysqlã€oracleï¼Œå…¶å®ä¸€åˆ‡æ”¯æŒlimitåˆ†é¡µçš„æ•°æ®åº“éƒ½å¯ä»¥ç”¨mysql
  page-sql-id: .*ListPage.* # æ¡ˆä¾‹ *.PageList.* å·¦å³é€šé…çš„æ„æ€ è¿™ä¸ªè¦å•ç‹¬æ¼”ç¤ºä¸€ä¸‹  
```

```java
//æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· mapper.java
List<User> getUserListPage(User user);

//mapper.xml
<select id="getUserListPage" resultType="User">
   select * from user
</select>
```

åªæœ‰åœ¨Mapperä¸­å†™æˆè¿™ç§æ ¼å¼æ‰èƒ½ç”Ÿå‘½è¦ä½¿ç”¨EasyPageåˆ†é¡µï¼Œåä¹‹ä¸æ·»åŠ ListPageçš„æŸ¥è¯¢å°±ä¸ä½¿ç”¨ã€‚

æ¯”å¦‚ï¼Œè¿™ç§ä¸ä½¿ç”¨åˆ†é¡µçš„å†™æ³•å°±æ˜ç™½äº†å§

```java
//æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· mapper.java
List<User> getUser(User user);

//mapper.xml
<select id="getUser" resultType="User">
   select * from user
</select>
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥å†™æˆè¿™æ ·

```java
//getUserLListPage,getUserListPageUser...ç­‰ç­‰åªè¦ä½ çš„é…ç½®èƒ½å¯¹ä¸Šçš„å°±è¡Œäº†
```

#### å®ä½“çš„å°è£…

åˆ†é¡µè‚¯å®šè¦æœ‰åˆ†é¡µå‚æ•°çš„ï¼Œè¿™é‡Œæä¾›äº†ä¸¤ç§åˆ†é¡µå‚æ•°å°è£…çš„æ–¹å¼

ç»§æ‰¿å’ŒæŒæœ‰ Pageç±»  **com.easy.page.pojo.Page**

```java
public class Page {
    private int showCount;      //æ¯é¡µæ˜¾ç¤ºè®°å½•æ•°
    private int totalPage;      //æ€»é¡µæ•°
    private int totalResult;    //æ€»è®°å½•æ•°
    private int currentPage;    //å½“å‰é¡µ
    private int currentResult;  //å½“å‰è®°å½•èµ·å§‹ç´¢å¼•
    //Get/Set..
```

##### ç»§æ‰¿Page

```java
@Data
@ToString
public class User extends Page implements Serializable {
    private Integer id;
    private String username;
    @JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")
    private Date birthday;
}
```

ç»§æ‰¿ä»¥åä¼šæŠŠTotalä¸¢å›åˆ°totalResultå±æ€§ä¸­ã€‚

##### æŒæœ‰Page

```java
@Data
@ToString
public class User extends Page implements Serializable {
    private Integer id;
    private String username;
    @JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")
    private Date birthday;
    private Page page = new Page();
}
```

ä¸€æ ·ä¼šä¸¢Totalä¸¢å›åˆ°æŒæœ‰çš„Pageå¯¹è±¡çš„totalResultå±æ€§ä¸­ï¼Œå±æ€§åå¿…é¡»ä¸ºpageã€‚

##### ç®€å•çš„æ¡ˆä¾‹

```java
@Test
void testMyPageUtils() {
    Page page = new Page();
    page.setCurrentPage(1);
    page.setShowCount(3);
    List<User> byPage = userService.findByPage(page);
    byPage.forEach(System.out::println);
}
```

```xml
<select id="findByPageListPage" resultType="User">
    select * from users
</select>
```

```java
public interface UserMapper {
    //å› ä¸ºsqlæ²¡æœ‰whereæ¡ä»¶ï¼Œæ‰€ä»¥ä¸ç”¨ç»§æ‰¿ä¹Ÿä¸ç”¨æŒæœ‰ï¼Œç›´æ¥ä¼ Pageåˆ†é¡µå¯¹è±¡
    List<User> findByPageListPage(Page page);
}
```

##### å¤‡æ³¨

ä¸€å¯¹å¤šï¼Œä¸€å¯¹ä¸€ï¼Œæ¡ä»¶æŸ¥è¯¢éƒ½æµ‹è¯•è¿‡äº†

### æ€»ç»“ 

PHè¿”å›ä¸€ä¸ª **Page<T>**ï¼Œä½†æ˜¯æºç é‡Œæ˜¯æ‹¦æˆªäº† **Executor.class**ï¼Œé©¬ä¸Šåƒé¥­äº†æ˜å¤©è§...ä¸èƒ½è€½è¯¯ä¸‹ç­ğŸ¤£ã€‚

æ‰“å¼€ **Page<T>** ç±»å¯ä»¥å‘ç°ç»§æ‰¿äº† **List** ç±»ï¼Œå¤§å®¶å¸¸ç”¨çš„ **getResult**æ–¹æ³•ä¹Ÿåªæ˜¯ **return this**ã€‚

è¿™å°±æ˜¯PHèƒ½ç›´æ¥ç»“æœçš„åŸå› ï¼Œè¿˜æœ‰**PageHepler.startPage()**å°±æ˜¯å°†å‚æ•°é…ç½®ä¸Šï¼ˆå…¨æ˜¯åºŸè¯...ğŸ˜®ï¼‰

çœ‹äº†ä¸€ä¼šPHçš„æ‹¦æˆªå’Œæ‰§è¡Œï¼Œäººå®¶å’Œå’±ä»¬æ‹¦æˆªçš„å†…ç½®å¯¹è±¡ä¸åŒï¼Œå¯¼è‡´è·å–åˆ°çš„è¿”å›ç»“æœä¸åŒï¼Œ**Executor**.**class**ç›´æ¥å°±æŠŠ **List**ç»“æœé›†æ‹¿å›æ¥ï¼Œæˆ‘ä»¬æ‹¦æˆªçš„ **Statment.class**åªèƒ½æ‹¿Mybatisçš„å¦ä¸€ä¸ªå†…ç½®å¯¹è±¡ **ResultSet.class**

æˆ‘å¯ä¸æƒ³å†ç”¨whileæ–¹å¼å»å–å€¼äº†ï¼Œä»£ç å¤ªä¸‘äº†ã€‚

ä¸Šé¢è¯´çš„å¦‚æœCOUNTä¸º0å°±ä¸å»æŸ¥è¯¢çš„æ“ä½œï¼Œè²Œä¼¼è¿˜åœ¨å†™ï¼Œç›´æ¥æ¨¡ä»¿PHè¿”å›Pageå¯¹è±¡ä¹Ÿåœ¨è€ƒè™‘ï¼Œä¸å¿™çš„æ—¶å€™ä¸€èµ·å†™å®Œå°±è¿™æ ·ã€‚

Oracleçš„æ²¡æœ‰æµ‹è¯•è¿‡....ä¿é‡